/**
 * adapt-strap
 * @version v0.2.9 - 2014-09-09
 * @link https://github.com/Adaptv/adapt-strap
 * @author Kashyap Patel (kashyap@adap.tv)
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
!function(e,a,t){"use strict";angular.module("adaptv.adaptStrap",["adaptv.adaptStrap.utils","adaptv.adaptStrap.treebrowser","adaptv.adaptStrap.tablelite","adaptv.adaptStrap.tableajax","adaptv.adaptStrap.loadingindicator","adaptv.adaptStrap.infinitedropdown"]).provider("$adConfig",function(){var e=this.iconClasses={expand:"glyphicon glyphicon-plus-sign",collapse:"glyphicon glyphicon-minus-sign",loadingSpinner:"glyphicon glyphicon-refresh ad-spin",firstPage:"glyphicon glyphicon-fast-backward",previousPage:"glyphicon glyphicon-backward",nextPage:"glyphicon glyphicon-forward",lastPage:"glyphicon glyphicon-fast-forward",sortAscending:"glyphicon glyphicon-chevron-up",sortDescending:"glyphicon glyphicon-chevron-down",sortable:"glyphicon glyphicon-resize-vertical",selectedItem:"glyphicon glyphicon-ok"},a=this.paging={request:{start:"skip",pageSize:"limit",page:"page",sortField:"sort",sortDirection:"sort_dir",sortAscValue:"asc",sortDescValue:"desc"},response:{itemsLocation:"data",totalItems:"pagination.totalCount"}};this.$get=function(){return{iconClasses:e,paging:a}}}),angular.module("adaptv.adaptStrap.infinitedropdown",["adaptv.adaptStrap.utils","adaptv.adaptStrap.loadingindicator"]).directive("adInfiniteDropdown",["$parse","$compile","$templateCache","$adConfig","adLoadPage","adDebounce","adStrapUtils","adLoadLocalPage",function(e,a,n,i,o,l,r,g){function s(s,c,p){s[p.dropdownName]={items:{list:[],paging:{currentPage:1,totalPages:t,pageSize:Number(p.pageSize)||10}},localConfig:{loadingData:!1,showDisplayProperty:p.displayProperty?!0:!1,showTemplate:p.template?!0:!1,loadTemplate:p.templateUrl?!0:!1,initialLabel:p.initialLabel||"Select",singleSelectionMode:e(p.singleSelectionMode)()?!0:!1,dynamicLabel:p.labelDisplayProperty?!0:!1,dimensions:{"max-height":p.maxHeight||"200px","max-width":p.maxWidth||"auto"}},selectedItems:s.$eval(p.selectedItems)||[],ajaxConfig:s.$eval(p.ajaxConfig),applyFilter:r.applyFilter,readProperty:r.getObjectProperty,isSelected:r.itemExistsInList};var d,u=s[p.dropdownName],m=n.get("infinitedropdown/infinitedropdown.tpl.html");u.addRemoveItem=function(e,a,t){e.stopPropagation(),u.localConfig.singleSelectionMode?u.selectedItems[0]=a:r.addRemoveItemFromList(a,t);var n=s.$eval(p.onItemClick);n&&n(a)},u.loadPage=l(function(e){d=Math.random(),u.localConfig.loadingData=!0;var a=s.$eval(p.pageLoader)||o,t={pageNumber:e,pageSize:u.items.paging.pageSize,sortKey:u.localConfig.predicate,sortDirection:u.localConfig.reverse,ajaxConfig:u.ajaxConfig,token:d},n=function(a){a.token===d&&(u.items.list=1===e?a.items:u.items.list.concat(a.items),u.items.paging.totalPages=a.totalPages,u.items.paging.currentPage=a.currentPage,u.localConfig.loadingData=!1)},i=function(){u.localConfig.loadingData=!1};p.localDataSource?(t.localData=s.$eval(p.localDataSource),n(g(t))):a(t).then(n,i)},10),u.loadNextPage=function(){u.localConfig.loadingData||u.items.paging.currentPage+1<=u.items.paging.totalPages&&u.loadPage(u.items.paging.currentPage+1)},u.loadPage(1),p.ajaxConfig&&s.$watch(p.ajaxConfig,function(){u.loadPage(1)},!0),p.localDataSource&&s.$watch(p.localDataSource,function(){u.loadPage(1)},!0),m=m.replace(/%=dropdownName%/g,p.dropdownName).replace(/%=displayProperty%/g,p.displayProperty).replace(/%=templateUrl%/g,p.templateUrl).replace(/%=template%/g,p.template).replace(/%=labelDisplayProperty%/g,p.labelDisplayProperty).replace(/%=btnClasses%/g,p.btnClasses||"btn btn-default").replace(/%=icon-selectedItem%/g,i.iconClasses.selectedItem),c.empty(),c.append(a(m)(s));var f=angular.element(c).find("ul")[0],C=l(function(){f.scrollTop+f.offsetHeight>=f.scrollHeight-300&&u.loadNextPage()},50);angular.element(f).bind("mousewheel",function(e){e.originalEvent&&e.originalEvent.deltaY&&(f.scrollTop+=e.originalEvent.deltaY,e.preventDefault(),e.stopPropagation()),C()})}return{restrict:"E",link:s}}]),angular.module("adaptv.adaptStrap.loadingindicator",[]).directive("adLoadingIcon",["$adConfig","$compile",function(e,a){return{restrict:"E",compile:function(){return{pre:function(t,n,i){var o=i.loadingIconClass||e.iconClasses.loadingSpinner,l=i.loadingIconSize?"ng-style=\"{'font-size': '"+i.loadingIconSize+"'}\"":"",r='<i class="'+o+'" '+l+"></i>";n.empty(),n.append(a(r)(t))}}}}}]).directive("adLoadingOverlay",["$adConfig",function(e){return{restrict:"E",templateUrl:"loadingindicator/loadingindicator.tpl.html",scope:{loading:"=",zIndex:"@",position:"@",containerClasses:"@",loadingIconClass:"@",loadingIconSize:"@"},compile:function(){return{pre:function(a){a.loadingIconClass=a.loadingIconClass||e.iconClasses.loading,a.loadingIconSize=a.loadingIconSize||"3em"}}}}}]),angular.module("adaptv.adaptStrap.tableajax",["adaptv.adaptStrap.utils","adaptv.adaptStrap.loadingindicator"]).directive("adTableAjax",["$parse","$compile","$templateCache","$adConfig","adLoadPage","adDebounce","adStrapUtils",function(e,a,n,i,o,l,r){function g(g,s,c){g[c.tableName]={items:{list:t,paging:{currentPage:1,totalPages:t,pageSize:t,pageSizes:e(c.pageSizes)()||[10,25,50]}},localConfig:{pagingArray:[],loadingData:!1},ajaxConfig:g.$eval(c.ajaxConfig),applyFilter:r.applyFilter,readProperty:r.getObjectProperty};var p,d=g[c.tableName],u=n.get("tableajax/tableajax.tpl.html");d.items.paging.pageSize=d.items.paging.pageSizes[0],d.loadPage=l(function(e){p=Math.random(),d.localConfig.loadingData=!0;var a=g.$eval(c.pageLoader)||o,t={pageNumber:e,pageSize:d.items.paging.pageSize,sortKey:d.localConfig.predicate,sortDirection:d.localConfig.reverse,ajaxConfig:d.ajaxConfig,token:p},n=function(e){e.token===p&&(d.items.list=e.items,d.items.paging.totalPages=e.totalPages,d.items.paging.currentPage=e.currentPage,d.localConfig.pagingArray=e.pagingArray,d.localConfig.loadingData=!1)},i=function(){d.localConfig.loadingData=!1};a(t).then(n,i)}),d.loadNextPage=function(){d.localConfig.loadingData||d.items.paging.currentPage+1<=d.items.paging.totalPages&&d.loadPage(d.items.paging.currentPage+1)},d.loadPreviousPage=function(){d.localConfig.loadingData||d.items.paging.currentPage-1>0&&d.loadPage(d.items.paging.currentPage-1)},d.loadLastPage=function(){d.localConfig.loadingData||d.items.paging.currentPage!==d.items.paging.totalPages&&d.loadPage(d.items.paging.totalPages)},d.pageSizeChanged=function(e){Number(e)!==d.items.paging.pageSize&&(d.items.paging.pageSize=Number(e),d.loadPage(1))},d.sortByColumn=function(e){e.sortKey&&(e.sortKey!==d.localConfig.predicate?(d.localConfig.predicate=e.sortKey,d.localConfig.reverse=!0):d.localConfig.reverse===!0?d.localConfig.reverse=!1:(d.localConfig.reverse=t,d.localConfig.predicate=t),d.loadPage(d.items.paging.currentPage))},d.loadPage(1),g.$watch(c.ajaxConfig,function(){d.loadPage(1)},!0),c.tableClasses=c.tableClasses||"table",c.paginationBtnGroupClasses=c.paginationBtnGroupClasses||"btn-group btn-group-sm",u=u.replace(/%=tableName%/g,c.tableName).replace(/%=columnDefinition%/g,c.columnDefinition).replace(/%=tableClasses%/g,c.tableClasses).replace(/%=paginationBtnGroupClasses%/g,c.paginationBtnGroupClasses).replace(/%=icon-firstPage%/g,i.iconClasses.firstPage).replace(/%=icon-previousPage%/g,i.iconClasses.previousPage).replace(/%=icon-nextPage%/g,i.iconClasses.nextPage).replace(/%=icon-lastPage%/g,i.iconClasses.lastPage).replace(/%=icon-sortAscending%/g,i.iconClasses.sortAscending).replace(/%=icon-sortDescending%/g,i.iconClasses.sortDescending).replace(/%=icon-sortable%/g,i.iconClasses.sortable),s.empty(),s.append(a(u)(g))}return{restrict:"E",link:g}}]),angular.module("adaptv.adaptStrap.tablelite",["adaptv.adaptStrap.utils"]).directive("adTableLite",["$parse","$http","$compile","$filter","$templateCache","$adConfig","adStrapUtils","adDebounce","adLoadLocalPage",function(e,a,n,i,o,l,r,g,s){function c(a,i,c){a[c.tableName]={items:{list:t,allItems:t,paging:{currentPage:1,totalPages:t,pageSize:t,pageSizes:e(c.pageSizes)()||[10,25,50]}},localConfig:{pagingArray:[],selectable:c.selectedItems?!0:!1,showPaging:e(c.disablePaging)()?!1:!0},selectedItems:a.$eval(c.selectedItems),applyFilter:r.applyFilter,isSelected:r.itemExistsInList,addRemoveItem:r.addRemoveItemFromList,addRemoveAll:r.addRemoveItemsFromList,allSelected:r.itemsExistInList,readProperty:r.getObjectProperty};var p=a[c.tableName],d=o.get("tablelite/tablelite.tpl.html");p.items.paging.pageSize=p.items.paging.pageSizes[0],p.loadPage=g(function(e){var t,n=[];angular.isArray(a.$eval(c.localDataSource))?n=a.$eval(c.localDataSource):angular.forEach(a.$eval(c.localDataSource),function(e){n.push(e)}),t={pageNumber:e,pageSize:p.localConfig.showPaging?p.items.paging.pageSize:n.length,sortKey:p.localConfig.predicate,sortDirection:p.localConfig.reverse,localData:n};var i=s(t);p.items.list=i.items,p.items.allItems=i.allItems,p.items.paging.currentPage=i.currentPage,p.items.paging.totalPages=i.totalPages,p.localConfig.pagingArray=i.pagingArray},100),p.loadNextPage=function(){p.items.paging.currentPage+1<=p.items.paging.totalPages&&p.loadPage(p.items.paging.currentPage+1)},p.loadPreviousPage=function(){p.items.paging.currentPage-1>0&&p.loadPage(p.items.paging.currentPage-1)},p.loadLastPage=function(){p.localConfig.disablePaging||p.loadPage(p.items.paging.totalPages)},p.pageSizeChanged=function(e){p.items.paging.pageSize=e,p.loadPage(1)},p.sortByColumn=function(e){e.sortKey&&(e.sortKey!==p.localConfig.predicate?(p.localConfig.predicate=e.sortKey,p.localConfig.reverse=!0):p.localConfig.reverse===!0?p.localConfig.reverse=!1:(p.localConfig.reverse=t,p.localConfig.predicate=t),p.loadPage(p.items.paging.currentPage))},p.loadPage(1),c.tableClasses=c.tableClasses||"table",c.paginationBtnGroupClasses=c.paginationBtnGroupClasses||"btn-group btn-group-sm",d=d.replace(/%=tableName%/g,c.tableName).replace(/%=columnDefinition%/g,c.columnDefinition).replace(/%=paginationBtnGroupClasses%/g,c.paginationBtnGroupClasses).replace(/%=tableClasses%/g,c.tableClasses).replace(/%=icon-firstPage%/g,l.iconClasses.firstPage).replace(/%=icon-previousPage%/g,l.iconClasses.previousPage).replace(/%=icon-nextPage%/g,l.iconClasses.nextPage).replace(/%=icon-lastPage%/g,l.iconClasses.lastPage).replace(/%=icon-sortAscending%/g,l.iconClasses.sortAscending).replace(/%=icon-sortDescending%/g,l.iconClasses.sortDescending).replace(/%=icon-sortable%/g,l.iconClasses.sortable),i.empty(),i.append(n(d)(a)),a.$watch(c.localDataSource,function(){p.loadPage(1)},!0)}return{restrict:"E",link:c}}]),angular.module("adaptv.adaptStrap.treebrowser",[]).directive("adTreeBrowser",["$compile","$http","$adConfig","$templateCache",function(e,a,t,n){function i(i,o,l){i[l.treeName]={toggle:function(e,a){var t;e.stopPropagation(),t=i.$eval(l.toggleCallback),t?t(a):a._ad_expanded=!a._ad_expanded},hasChildren:function(e){var a=i.$eval(l.hasChildren),t=e[l.childNode]&&e[l.childNode].length>0;return a&&(t=a(e)),t},localConfig:{showHeader:l.nodeHeaderUrl?!0:!1}};var r=l.treeName||"",g=l.nodeTemplateUrl||"",s=l.nodeHeaderUrl||"",c=l.childrenPadding||15,p="",d=function(a,g){var s=n.get("treebrowser/treebrowser.tpl.html");p=s.replace(/%=treeName%/g,r).replace(/%=treeRootName%/g,l.treeRoot).replace(/%=bordered%/g,l.bordered).replace(/%=icon-expand%/g,t.iconClasses.expand).replace(/%=icon-collapse%/g,t.iconClasses.collapse).replace(/%=icon-loadingSpinner%/g,t.iconClasses.loadingSpinner).replace(/%=childNodeName%/g,l.childNode).replace(/%=childrenPadding%/g,c).replace(/%=rowNgClass%/g,l.rowNgClass||"").replace(/%=nodeTemplate%/g,a).replace(/%=nodeHeaderTemplate%/g,g||""),o.empty(),o.append(e(p)(i))};""!==g?a.get(g,{cache:n}).success(function(e){""!==s?a.get(s,{cache:n}).success(function(a){d(e,a)}):d(e,"")}):d('<span>{{ item.name || "" }}</span>')}return{restrict:"E",link:i}}]),angular.module("adaptv.adaptStrap.utils",[]).factory("adStrapUtils",["$filter",function(e){var a=function(e,a){var t=a.split(".");if(e)for(;t.length;)e&&(e=e[t.shift()]);return e},t=function(a,t){var n,i;return t&&(n=t.split(":"),i=n[1],a=i?e(n[0])(a,i):e(n[0])(a)),a},n=function(e,a){var t=!1;return a.forEach(function(a){angular.equals(e,a)&&(t=!0)}),t},i=function(e,a){var t,i=!0;for(t=0;t<e.length;t++)if(n(e[t],a)===!1){i=!1;break}return i},o=function(e,a){a.push(e)},l=function(e,a){var t;for(t=a.length-1;t>-1;t--)angular.equals(e,a[t])&&a.splice(t,1)},r=function(e,a){var t,n=!1;for(t=a.length-1;t>-1;t--)angular.equals(e,a[t])&&(a.splice(t,1),n=!0);n===!1&&a.push(e)},g=function(e,a){e.forEach(function(e){n(e,a)||r(e,a)})},s=function(e,a){i(e,a)?a.length=0:g(e,a)},c=function(e,a){for(var t=a.split(".");t.length;)e=e[t.shift()];return e};return{evalObjectProperty:a,applyFilter:t,itemExistsInList:n,itemsExistInList:i,addItemToList:o,removeItemFromList:l,addRemoveItemFromList:r,addItemsToList:g,addRemoveItemsFromList:s,getObjectProperty:c}}]).factory("adDebounce",["$timeout","$q",function(e,a){var t=function(t,n,i,o){var l=null,r=a.defer(),g=n||300;return function(){var n=o||this,s=arguments,c=i&&!l,p=function(){i||(r.resolve(t.apply(n,s)),r=a.defer())};return l&&e.cancel(l),l=e(p,g),c&&(r.resolve(t.apply(n,s)),r=a.defer()),r.promise}};return t}]).directive("adCompileTemplate",["$compile",function(e){return function(a,t,n){a.$watch(function(e){return e.$eval(n.adCompileTemplate)},function(n){t.html(n),e(t.contents())(a)})}}]).factory("adLoadPage",["$adConfig","$http","adStrapUtils",function(e,a,t){return function(n){var i=(n.pageNumber-1)*n.pageSize,o=angular.copy(e.paging),l=angular.copy(n.ajaxConfig);l.paginationConfig&&l.paginationConfig.request&&angular.extend(o.request,l.paginationConfig.request),l.paginationConfig&&l.paginationConfig.response&&angular.extend(o.response,l.paginationConfig.response),l.params[o.request.start]=i,l.params[o.request.pageSize]=n.pageSize,l.params[o.request.page]=n.pageNumber,n.sortKey&&(l.params[o.request.sortField]=n.sortKey),n.sortDirection===!1?l.params[o.request.sortDirection]=o.request.sortAscValue:n.sortDirection===!0&&(l.params[o.request.sortDirection]=o.request.sortDescValue);var r;return r="JSONP"===l.method?a.jsonp(l.url+"?callback=JSON_CALLBACK",l):a(l),r.then(function(e){for(var a={items:t.evalObjectProperty(e.data,o.response.itemsLocation),currentPage:n.pageNumber,totalPages:Math.ceil(t.evalObjectProperty(e.data,o.response.totalItems)/n.pageSize),pagingArray:[],token:n.token},i=5,l=n.pageNumber-Math.floor(i/2),r=l;r<=n.pageNumber;r++)r>0&&a.pagingArray.push(r);for(;a.pagingArray.length<i&&!(r>a.totalPages);)a.pagingArray.push(r),r++;return a})}}]).factory("adLoadLocalPage",["$filter",function(e){return function(a){var n,i,o={items:t,currentPage:a.pageNumber,totalPages:t,pagingArray:[],token:a.token},l=(a.pageNumber-1)*a.pageSize,r=l+a.pageSize,g=[];angular.isArray(a.localData)?g=a.localData:angular.forEach(a.localData,function(e){g.push(e)}),i=e("orderBy")(g,a.sortKey,a.sortDirection),o.items=i.slice(l,r),o.allItems=g,o.currentPage=a.pageNumber,o.totalPages=Math.ceil(g.length/a.pageSize);var s=5,c=a.pageNumber-Math.floor(s/2);for(n=c;n<=a.pageNumber;n++)n>0&&o.pagingArray.push(n);for(;o.pagingArray.length<s&&!(n>o.totalPages);)o.pagingArray.push(n),n++;return o}}])}(window,document);